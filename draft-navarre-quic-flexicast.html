<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Flexicast QUIC: combining unicast and multicast in a single QUIC connection</title>
<meta content="Louis Navarre" name="author">
<meta content="Olivier Bonaventure" name="author">
<meta content="
       This document proposes Flexicast QUIC, a simple extension to Multipath
QUIC that enables a source to send the same information to a set of
receivers using a combination of unicast paths and multicast distribution trees. 
    " name="description">
<meta content="xml2rfc 3.23.2" name="generator">
<meta content="quic" name="keyword">
<meta content="multicast" name="keyword">
<meta content="flexicast" name="keyword">
<meta content="draft-navarre-quic-flexicast-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.23.2
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-navarre-quic-flexicast.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">FC-QUIC</td>
<td class="right">October 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Navarre &amp; Bonaventure</td>
<td class="center">Expires 20 April 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">QUIC</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-navarre-quic-flexicast-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-10-17" class="published">17 October 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-04-20">20 April 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">L. Navarre</div>
<div class="org">UCLouvain</div>
</div>
<div class="author">
      <div class="author-name">O. Bonaventure</div>
<div class="org">UCLouvain</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Flexicast QUIC: combining unicast and multicast in a single QUIC connection</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document proposes Flexicast QUIC, a simple extension to Multipath
QUIC that enables a source to send the same information to a set of
receivers using a combination of unicast paths and multicast distribution trees.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-navarre-quic-flexicast/">https://datatracker.ietf.org/doc/draft-navarre-quic-flexicast/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        QUIC Working Group mailing list (<span><a href="mailto:quic@ietf.org">mailto:quic@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/quic/">https://mailarchive.ietf.org/arch/browse/quic/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/quic/">https://www.ietf.org/mailman/listinfo/quic/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/louisna/draft-navarre-quic-flexicast">https://github.com/louisna/draft-navarre-quic-flexicast</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 20 April 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-flexicast-quic" class="internal xref">Flexicast QUIC</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-extensions-to-multipath-qui" class="internal xref">Extensions to Multipath QUIC.</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-handshake-negotiation-and-t" class="internal xref">Handshake Negotiation and Transport parameter</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-initialisation-of-a-flexica" class="internal xref">Initialisation of a Flexicast Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-flexicast-flow-announcement-2" class="internal xref">Flexicast Flow Announcement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-joining-a-flexicast-flow" class="internal xref">Joining a Flexicast Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-underlying-multicast-networ" class="internal xref">Underlying multicast network</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-flexicast-flow-memberhsip-m" class="internal xref">Flexicast flow memberhsip management</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-receiver-side-management" class="internal xref">Receiver-side management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-source-side-management" class="internal xref">Source-side management</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-reliability" class="internal xref">Reliability</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-flow-and-congestion-control" class="internal xref">FLow and Congestion Control</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-packet-protection" class="internal xref">Packet protection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-protection-keys" class="internal xref">Protection Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-nonce-calculation" class="internal xref">Nonce Calculation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-key-update" class="internal xref">Key Update</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-new-frames" class="internal xref">New Frames</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-fc_announce-frame" class="internal xref">FC_ANNOUNCE frame</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-fc_state-frame" class="internal xref">FC_STATE frame</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a href="#section-10.2.1" class="auto internal xref">10.2.1</a>.  <a href="#name-fc_state-actions" class="internal xref">FC_STATE actions</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-fc_key-frame" class="internal xref">FC_KEY frame</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.1">
                    <p id="section-toc.1-1.10.2.3.2.1.1"><a href="#section-10.3.1" class="auto internal xref">10.3.1</a>.  <a href="#name-fc_key-algorithms" class="internal xref">FC_KEY algorithms</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-discussion" class="internal xref">Discussion</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sec-intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Starting from the initially efforts of Steve Deering <span>[<a href="#RFC1112" class="cite xref">RFC1112</a>]</span>, the IETF
has developed a range of IP multicast solutions that enable the efficient
transmission of a single packet to a group of receivers. In this document,
we focus on Source-Specific Multicast for IP <span>[<a href="#RFC4607" class="cite xref">RFC4607</a>]</span>, but the solution
proposed could also be applied to other forms of IP Multicast.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Although IP Multicast is not a new solution, it is not as widely used by
applications as popular transport protocols like TCP <span>[<a href="#RFC9293" class="cite xref">RFC9293</a>]</span> or QUIC <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>
do not support multicast.
Current IP Multicast applications include IP TV distribution in ISP networks
and trading services for financial institutions. Many reasons explain the difficulty
of deploying IP Multicast <span>[<a href="#DIOT" class="cite xref">DIOT</a>]</span>. From the application's viewpoint, a
key challenge with IP Multicast is that even if there is a unicast path
between two hosts, there is no guarantee that it will be possible to create and
maintain a multicast tree between these two hosts to efficiently exchange
data using IP multicast. To cope with this problem, the applications must
implement a multicast solution and a unicast solution. This increases the
complexity and the cost of the application.
For this reason, many applications that send
the same information to a large set of receivers like streaming services
or software updates, still rely on TCP or QUIC over unicast. This is inefficient from
the network viewpoint as the network carries the same information multiple
times.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The deployment of QUIC opens an interesting opportunity to reconsider the
utilization of IP Multicast. As QUIC runs above UDP, it could easily use
IP multicast to deliver information along multicast trees. Multicast
extensions to QUIC have already been proposed in
<span>[<a href="#I-D.pardue-quic-http-mcast" class="cite xref">I-D.pardue-quic-http-mcast</a>]</span> and <span>[<a href="#I-D.jholland-quic-multicast-05" class="cite xref">I-D.jholland-quic-multicast-05</a>]</span>.
To our knowledge, these extensions have not been fully implemented and deployed.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Flexicast QUIC takes a different approach. Instead of extending QUIC <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>,
Flexicast QUIC extends Multipath QUIC <span>[<a href="#MULTIPATH-QUIC" class="cite xref">MULTIPATH-QUIC</a>]</span>. Multipath QUIC
already includes several features that are very useful to allow a QUIC
connection to use unicast and multicast simultaneously.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Flexicast QUIC proposes a simple extension to Multipath QUIC that enables to share an
additional path between multiple receivers. The destination address of
this path can be a multicast IP address and rely on a multicast forwarding
mechanism (e.g., IP Multicast) to transmit the packets.
This document defines the core design of Flexicast QUIC starting from Multipath QUIC.
Side documents will further expand this design to add new features.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This document is organized as follows. After having specified some conventions
in <a href="#sec-conventions" class="auto internal xref">Section 2</a>, we provide a brief overview of Flexicast QUIC in
<a href="#sec-flexicast" class="auto internal xref">Section 3</a>. We describe in more details the Flexicast QUIC handshake
in <a href="#sec-handshake" class="auto internal xref">Section 4</a> and then the new QUIC frames in <a href="#sec-frames" class="auto internal xref">Section 10</a>.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-conventions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-flexicast">
<section id="section-3">
      <h2 id="name-flexicast-quic">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-flexicast-quic" class="section-name selfRef">Flexicast QUIC</a>
      </h2>
<p id="section-3-1">Multipath QUIC was designed to enable the simultaneous utilization of multiple
paths inside one QUIC connection. A Multipath QUIC connection
starts with a handshake like a regular QUIC connection, besides the utilization
of the initial_max_path_id to negotiate the multipath extension. This parameter
specifies the maximum path identifier that an endpoint is willing to maintain
at connection establishment. Multipath QUIC requires the utilization of non-zero
connection identifiers and uses explicit path identifiers and one packet number
space per path. Multipath QUIC assumes that the additional paths are created
by the client using the server address of the initial paths.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Consider as an example a smartphone that uses Multipath QUIC. This smartphone
has a Wi-Fi and a cellular interface. The smartphone has created the QUIC
connection over the cellular interface. After the handshake, the smartphone
and the server have exchanged additional connection identifiers. To create a
new path over the Wi-Fi interface, the smartphone sends a PATH_CHALLENGE over
this path using one of the connection identifiers advertised by the server.
The server replies with a PATH_RESPONSE using one of the connection
identifiers advertised by the smartphone. The smartphone confirms the establishment
of the second path using a PATH_RESPONSE. At this point that smartphone and the
server have two paths to exchange data: the first over the cellular interface
and the second over the Wi-Fi interface. Each path uses a different sequence number
space, but QUIC packets are encrypted using the same connection keys over both paths.
When a QUIC packet needs to be send, the packet scheduler selects the relevant path.
If a QUIC frame is lost over one path, it can be retransmitted over the other
paths.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Flexicast QUIC extends Multipath QUIC by requiring that each path uses different
encryption and decryption keys. As such, multiple clients can share the same additional
path which is encrypted with a different key than their respective unicast path.
The IP destination address of this new, shared path <span class="bcp14">MAY</span> be a multicast address,
so that all receivers with multicast support receive the same packet.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">To illustrate the operation of Flexicast QUIC, we consider a scenario with
one source, S, and three receivers: R1, R2 and R3. R1 and R2 are attached to
a network where it is possible to create an IP multicast tree from S to R1 and R2.
R3 is attached to an IP network where unicast works perfectly, but IP multicast
does not. Once the Flexicast QUIC connection will be established, S will be
able to send data along the multicast tree to reach R1 and R2 and using unicast
to reach R3. This is illustrated in <a href="#figfc1" class="auto internal xref">Figure 1</a>.<a href="#section-3-4" class="pilcrow">¶</a></p>
<span id="name-a-flexicast-quic-connection"></span><div id="figfc1">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-3-5.1">
<pre>
           IP Multicast tree
  S --------------------+-----&gt; R1
  \                     |
   \                    +-----&gt; R2
    \            Unicast network
     +------------------------&gt; R3

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-a-flexicast-quic-connection" class="selfRef">A Flexicast QUIC connection where source S sends a data packet to R1 and R2 using a multicast tree and to R3 using unicast</a>
        </figcaption></figure>
</div>
<p id="section-3-6">A Flexicast QUIC connection starts with a handshake like a regular QUIC
connection. R1, R2 and R3 establish a connection to S using the flexicast_support
and the initial_max_path_id transport parameters.
The initial path between each receiver and the source are individually secured using
the keys derived at connection establishement. They remain open during the whole
communication and constitute a unicast bidirectional channel between the source and
each receiver. This path is used for two very different purposes.
First, it acts as a control channel and enables the source to
exchange control information with each receiver. Second, it can be used to transmit
or retransmit data that cannot be delivered along the multicast tree.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">Most of the data sent over a Flexicast QUIC connection is transmitted along what
we call a flexicast flow. A <strong>flexicast flow</strong> is a unidirectional path from a source
to a group of receivers. An important characteristic of a flexicast flow is that
all the packets sent by the source over this flow are secured using keys that are
shared between the source and the receivers attached to the flexicast flow.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">Flexicast QUIC supports two types of flexicast flows. The first type flexicast flow
is an IP multicast tree. A source creates an IP multicast tree and selects a set
of encryption and authentication keys. It then advertises the source and
group address of this flexicast flow using the FC_ANNOUNCE frame to
the receivers that join the multicast tree. The source then uses the FC_KEY frame
to avertise the shared keys to each receiver. They can now receive and decrypt
the data sent by the source along the multicast tree.
The Flexicast QUIC source uses this flexicast flow to efficiently sends data to multiple receivers
simultaneously (R1 and R2 in <a href="#fig-flexicast-2" class="auto internal xref">Figure 2</a>).
R1 and R2 use their unicast path, created at connection establishment, to return acknowledgments.
A source can retransmit lost data either on the flexicast flow or over a specific unicast path,
e.g. when some data was missing at only one receiver.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">Flexicast QUIC supports non-multicast-capable receivers in two different ways. A first
approach is to use the unicast path to deliver the data to such receivers. This implies
that each data must be authenticated and encrypted using the TLS keys derived over each
unicast path. This is not efficient when there are multiple receivers.
Flexicast QUIC supports a second type of flexicast flow which improves performance when
there are multiple unicast receivers. For these receivers, it is more efficient from the
source viewpoint to encrypt and authenticate each QUIC packet using shared keys and then
send a copy of this packet to all receivers, e.g. using system calls such as sendmmsg.
In this case, the source maintains a flexicast flow where it replicates each packet
towards each receiver. It also sends an FC_ANNOUNCE frame to advertise the flexicast flow,
using the receiver's IP address as a destination instead of a multicast address and later
an FC_KEY frame containing the shared keys.<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">In this example, R3 lies in a non-multicast-capable network, and cannot receive content through the
flexicast flow. Instead, it relies on its unicast path, created at connection establishment to receive
data from the source.<a href="#section-3-10" class="pilcrow">¶</a></p>
<span id="name-a-flexicast-quic-connection-"></span><div id="fig-flexicast-2">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-3-11.1">
<pre>
+----------------------------------------+
|   +----------------------------+       |    =======&gt; flexicast flow
|   |                            |       |
|   |                            |       |    &lt;------&gt; unicast path
|   v      239.239.23.35:4433    v       |
+-&gt; S ==============+==========&gt; R1      |
    ^               \\                   v
    |                +=================&gt; R2
    |
    +----------------------------&gt; R3
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-a-flexicast-quic-connection-" class="selfRef">A Flexicast QUIC connection is composed of two types of paths: (1) one bidirectional, unique, unicast path between the source and each receiver and (2) a flexicast flow from the source to a set of receivers relyinf on a multicast distribution tree</a>
        </figcaption></figure>
</div>
<p id="section-3-12">At any point in time, if the network condition of a receiver listening to the Flexicast flow degrades, e.g., because the underlying multicast tree fails or because the receiver moves into a non-multicast network, it <span class="bcp14">MAY</span> leave the Flexicast flow and continue receiving content through its unicast path, similarly to R3.
The seamless transition between the flexicast flow and unicast path is possible because these are Multipath QUIC paths.<a href="#section-3-12" class="pilcrow">¶</a></p>
<div id="extensions-to-multipath-quic">
<section id="section-3.1">
        <h3 id="name-extensions-to-multipath-qui">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-extensions-to-multipath-qui" class="section-name selfRef">Extensions to Multipath QUIC.</a>
        </h3>
<p id="section-3.1-1">Flexicast QUIC modifies Multipath QUIC is several ways to enable the
utilization of a shared unidirectional path, the flexicast flow, as one of the Multipath QUIC paths.
The flexicast flow can be transported on top of an IP multicast distribution tree to reach several receivers simultaneously,
which brings several challenges:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1-2">
<li id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">An IP multicast tree is unidirectional, in contrast with a Multipath QUIC path.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">An IP multicast tree is identified by a pair &lt;source address, group address&gt;.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">All the receivers attached to an IP Multicast tree receive the same packet.<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.1-3">Since an IP multicast tree is unidirectional, it is impossible to use the QUIC
path challenge/response mechanism to create the flexicast flow along an IP multicast tree.
Flexicast QUIC only uses path challenge/response on unicast paths.
Flexicast QUIC replaces the explicit path challenge/response from Multipath QUIC
to create the flexicast flow by an implicit path creation.
Since the destination address of this new "path" is a multicast IP address, it is impossible for
receivers to test its reachability from the source.
An underlying mechanism (e.g., using IGMP) <span class="bcp14">SHOULD</span> provide feedback to the receiver on the
reachability of the flexicast flow at the IP multicast address provided by the source.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">Furthermore, the data received over the flexicast flow cannot be acknowledged over this path
since it is unidirectional.
Because Flexicast QUIC uses Multipath QUIC, ACK frames are replaced by MP_ACK frames.
Flexicast QUIC receivers <span class="bcp14">MUST</span> send acknowledgments to the source using MP_ACK frames
sent on their unicast path.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">To join the flexicast flow, the receivers must be informed of the source
and group addresses of this tree. The server uses the FC_ANNOUNCE frame to
advertise the identifier of the multicast tree that the receivers can join.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">The Flexicast QUIC packets that are sent over the flexicast flow must
be encrypted and authenticated. However, these packets cannot be encrypted using
the TLS keys derived during the QUIC connection establishment since each unicast
path has its own set of TLS keys. To secure the transmission of Flexicast QUIC
packets along the flexicast flow, the source generates an independent set of
security keys and shares them using the FC_KEY frame (see <a href="#fc-key-frame" class="auto internal xref">Section 10.3</a>) to all receivers over
the unicast path. Since this frame is sent over the unicast paths, it is authenticated
and encrypted using the TLS keys associated to each unicast path.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7"><a href="#sec-packet-protection" class="auto internal xref">Section 9</a> gives more details on the changes from <span>[<a href="#MULTIPATH-QUIC" class="cite xref">MULTIPATH-QUIC</a>]</span> to protect packets sent on the flexicast flow.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-handshake">
<section id="section-4">
      <h2 id="name-handshake-negotiation-and-t">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-handshake-negotiation-and-t" class="section-name selfRef">Handshake Negotiation and Transport parameter</a>
      </h2>
<p id="section-4-1">This extension defines a new transport parameter, used to negotiate the use of the flexicast extensiong during the connection handshake, as specified in <span>[<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.
The new transport parameter is defined as follows:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">flexicast_support (current version uses TBD-03): the presence of this transport parameter indicates support of the flexicast extension. The transport parameter contains two boolean values, respectively indicating support of IPv4 and IPv6 for multicast addresses. If an endpoint receives the flexicast_support transport parameter with both IPv4 and IPv6 supports set to false (0), it must close the connection with an error type of FC_PROTOCOL_VIOLATION.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">The support of the flexicast extension is conditioned to the support of the multipath extension, as defined in <span>[<a href="#MULTIPATH-QUIC" class="cite xref">MULTIPATH-QUIC</a>]</span>.
Since a Flexicast flow is a new multipath path, the support of multipath, with sufficient (e.g., at least 2) path ID, is required, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-multipath-10#section-2" class="relref">Section 2</a> of [<a href="#MULTIPATH-QUIC" class="cite xref">MULTIPATH-QUIC</a>]</span>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">An endpoint receiving the flexicast_support transport parameter from its peer, without support for multicast <span class="bcp14">MUST</span> ignore the flexicast_support transport parameter, as if the peer does not support the flexicast extension.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">The extension does not change the definition of the transport parameters defined in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-18.2" class="relref">Section 18.2</a> of [<a href="#QUIC-TRANSPORT" class="cite xref">QUIC-TRANSPORT</a>]</span>.<a href="#section-4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initialisation-of-a-flexicast-flow">
<section id="section-5">
      <h2 id="name-initialisation-of-a-flexica">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-initialisation-of-a-flexica" class="section-name selfRef">Initialisation of a Flexicast Flow</a>
      </h2>
<p id="section-5-1">This section details how a Flexicast QUIC source advertises flexicast flows and how receivers join them.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2"><a href="#fig-join-flexicast-flow" class="auto internal xref">Figure 3</a> illustrates how a Flexicast QUIC source and receiver exchange frames on the unicast path to advertise and join a flexicast flow.<a href="#section-5-2" class="pilcrow">¶</a></p>
<span id="name-flexicast-flow-announcement"></span><div id="fig-join-flexicast-flow">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-5-3.1">
<pre>
Source                                        Receiver

QUIC handshake      &lt;------------&gt;      QUIC handshake

FC_ANNOUNCE         -------------&gt;
                    &lt;-------------      FC_STATE(JOIN)
FC_KEY              -------------&gt;
                    &lt;-------------    FC_STATE(LISTEN)
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-flexicast-flow-announcement" class="selfRef">Flexicast flow announcement and join</a>
        </figcaption></figure>
</div>
<div id="flexicast-flow-announcement">
<section id="section-5.1">
        <h3 id="name-flexicast-flow-announcement-2">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-flexicast-flow-announcement-2" class="section-name selfRef">Flexicast Flow Announcement</a>
        </h3>
<p id="section-5.1-1">A Flexicast QUIC source announces flexicast flows through the FC_ANNOUNCE frame (see <a href="#fc-announce-frame" class="auto internal xref">Section 10.1</a>).
Flexicast QUIC replaces the concept of Connection ID with the Flexicast Flow ID. Concretelly, these two terms refer to the same concept.
Since the flexicast flow is unidirectional, refering to this value as a "connection" ID would be quite ambiguous.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Through the FC_ANNOUNCE frame, the source advertises the Flexicast FLow ID of the flexicast flow to listen to.
As the Flexicast Flow ID will serve as a "destination Connection ID" for the flexicast flow, receivers willing to join the flexicast flow
<span class="bcp14">MUST</span> add this Flexicast Flow ID as a new "source Connection ID".
<em>TODO: how to handle the case were the receiver already has this Flexicast Flow ID as a source Connection ID?</em><a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The FC_ANNOUNCE frame also contains routing information, i.e., the IP multicast destination address carrying flexicast flow packets, and the UDP destination port that the receivers <span class="bcp14">MUST</span> listen to.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">The source <span class="bcp14">MAY</span> advertise multiple distinct flexicast flows to the same receivers, i.e., flexicast flows with distinct Flexicast Flow ID.
The source <span class="bcp14">MAY</span> advertise updated information about a specific flexicast flow by sending new FC_ANNOUNCE frames with increased sequence numbers.
Upon reception of a new FC_ANNOUNCE frame updating information of an existing flexicast flow with an increased sequence number compared to the last received FC_ANNOUNCE frame, a receiver <span class="bcp14">MUST</span> update flexicast flow information.
Upon reception of a new FC_ANNOUNCE frame updating information of an existing flexicast flow with a smaller sequence number compared to the last received FC_ANNOUNCE frame, a receiver <span class="bcp14">MUST</span> silently discard the new FC_ANNOUNCE frame.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-join-fc-flow">
<section id="section-5.2">
        <h3 id="name-joining-a-flexicast-flow">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-joining-a-flexicast-flow" class="section-name selfRef">Joining a Flexicast Flow</a>
        </h3>
<p id="section-5.2-1">After receiving an FC_ANNOUNCE frame dvertising a flexicast flow, a receiver <span class="bcp14">MAY</span> decide to join it.
Flexicast flow management is handled with the FC_STATE frame (see <a href="#fc-state-frame" class="auto internal xref">Section 10.2</a>).
The receiver sends an FC_STATE frame with the Flexicast Flow ID of the flexicast flow it wants to join and the JOIN action.
<em>TODO: add a finite state machine of the receiver and source status.</em><a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">At this point, the Flexicast QUIC source <span class="bcp14">MAY</span> still decide to unauthorize the receiver to listen to the flexicast flow.
However, a Flexicast QUIC source having advertised a flexicast flow through an FC_ANNOUNCE <span class="bcp14">SHOULD</span> accept a receiver to join
it after receiving the corresponding FC_STATE frame with the JOIN action.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">In the positive case, the source sends an FC_KEY frame, containing the TLS keys necessary for the receiver to decrypt packets
received on the flexicast flow. The frame also contains the first packet number that the receiver <span class="bcp14">SHOULD</span> receive with this key.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">Once the receiver received the FC_KEY frame and its underlying multicast network is ready to transmit packets with the IP multicast
address from the FC_ANNOUNCE frame as destination address, it sends an FC_STATE frame to the source with the LISTEN action.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">The Flexicast QUIC source <span class="bcp14">SHOULD NOT</span> consider the receiver as a full member of the flexicast flow until it receives an
FC_STATE with the LISTEN action from the receiver.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="underlying-multicast-network">
<section id="section-5.3">
        <h3 id="name-underlying-multicast-networ">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-underlying-multicast-networ" class="section-name selfRef">Underlying multicast network</a>
        </h3>
<p id="section-5.3-1">After sending the FC_STATE frame with the JOIN action, the receiver <span class="bcp14">MAY</span> decide to notify the underlying multicast routing network
its willingness to receive packets from the flexicast flow that will be sent by the source on the IP multicast address advertised
in the FC_ANNOUNCE frame. The receiver <span class="bcp14">MAY</span> also wait to receive the FC_KEY frame of the corresponding flexicast flow to avoid
receiving packets that it will not be able to process before receiving the required TLS keys.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-leave">
<section id="section-6">
      <h2 id="name-flexicast-flow-memberhsip-m">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-flexicast-flow-memberhsip-m" class="section-name selfRef">Flexicast flow memberhsip management</a>
      </h2>
<p id="section-6-1">A Flexicast QUIC source exactly knows the set of receivers listening to a specific flexicast flow.
Receivers <span class="bcp14">MAY</span> decide, at any point in time during the communication, to leave the flexicast flow.
However, receivers <span class="bcp14">SHOULD</span> only leave a flexicast flow only if network conditions are not met to
ensure a good quality of experience for the applications.
The exact metrics defining "good enough network conditions" is out of scope of this document,
and <span class="bcp14">MUST</span> be provided by the application.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="receiver-side-management">
<section id="section-6.1">
        <h3 id="name-receiver-side-management">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-receiver-side-management" class="section-name selfRef">Receiver-side management</a>
        </h3>
<p id="section-6.1-1">Receivers leave a flexicast flow membership by sending an FC_STATE frame with the LEAVE action.
Upon reception of this frame, the Flexicast QUIC source <span class="bcp14">MUST NOT</span> consider anymore the receiver
as a member of the flexicast flow, and it <span class="bcp14">MUST</span> continue transmitting data through the unicast path
with the receiver.
The receiver <span class="bcp14">SHOULD</span> drop any path state for the flexicast flow regarding.
The finite-state machine on the receiver-side <span class="bcp14">MUST</span> be reset to the same state as when it received
the FC_ANNOUNCE for the first time.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">A receiver that previously left a flexicast flow <span class="bcp14">MAY</span> attempt to join again the same flow by
restarting the phases from <a href="#sec-join-fc-flow" class="auto internal xref">Section 5.2</a>. Receiving a new FC_KEY is mandatory if
the Flexicast QUIC source uses group-key management systems to ensure backward and forward
secrecy.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Applications <span class="bcp14">SHOULD</span> provide a mechanism to avoid malicious receivers to periodically join and leave
the same flexicast flow to saturate the Flexicast QUIC source.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="source-side-management">
<section id="section-6.2">
        <h3 id="name-source-side-management">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-source-side-management" class="section-name selfRef">Source-side management</a>
        </h3>
<p id="section-6.2-1">At any point in time, the Flexicast QUIC source <span class="bcp14">MAY</span> decide to unilaterally remove a receiver from a flexicast flow, by sending an FC_STATE frame with the LEAVE action.
A malicious receiver might decide to ignore the frame; that is why this decision is done unilaterally, since for the source, the receiver is out of the flexicast flow.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Reasons to decide on the source-side to remove receivers from the flexicast flow include:
- A receiver is a bottleneck on the flexicast flow, i.e., the bit-rate of the flexicast flow becomes too low because of this receiver.
  In that case, the bottleneck receiver is removed from the specific flexicast flow. The source can continue distributing the content either through
  the unicast path with this receiver, or by letting the receiver join another flexicast flow which transmits data at a lower bit-rate.
- A receiver experiences too many losses. Receivers send feedback to the source. Too many losses degrade the quality of experience for the applications.
  To recover from them, there is a need for retransmissions, which can take up to several RTTs. The source <span class="bcp14">SHOULD</span> decive to remove the receiver from the
  flexicast flow and continue receiving data through unicast, even temporarilly. A reason why it would be better to continue through the unicast path
  is that the underlying IP multicast tree may be failing.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">The two aforementionned reasons could include malicious receivers whishing to degrade the overall performance of communication through the flexicast flow.
By letting the source unilaterally decide to remove receivers from a flexicast flow, the impact of malicious receivers is limited.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="reliability">
<section id="section-7">
      <h2 id="name-reliability">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-reliability" class="section-name selfRef">Reliability</a>
      </h2>
<p id="section-7-1">The reliability mechanism of Flexicast QUIC uses the standard QUIC mechanism.
This section only details the reliability mechanism for frames sent on the flexicast flow.
This document does not alter the reliability mechanism of QUIC as defined in <span>[<a href="#RFC9002" class="cite xref">RFC9002</a>]</span> for packets sent on the unicast path.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Receivers regularly send MP_ACK frames back to the source on their unicast path. Receivers <span class="bcp14">MUST NOT</span> send MP_ACK on the flexicast flow since this path is unidirectional.
A Flexicast QUIC source receiving an MP_ACK from a receiver on the flexicast flow <span class="bcp14">MUST</span> close the connection with this receiver with an error of type FC_PROTOCOL_VIOLATION.
The MP_ACK frames sent by the receivers on their unicast path include the <code>space_id</code> field to refer to the flexicast flow.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">A major change between <span>[<a href="#RFC9002" class="cite xref">RFC9002</a>]</span>, and to some extend <span>[<a href="#MULTIPATH-QUIC" class="cite xref">MULTIPATH-QUIC</a>]</span> with this document is that a Flexicast QUIC takes into account acknowledgments from multiple receivers for the same data.
A Flexicast QUIC source <span class="bcp14">MUST</span> wait for the acknowledgment from all receivers listening to the flexicast flow before releasing state for the transmitted data.
An acknowledgment-aggregation mechanism <span class="bcp14">MUST</span> be implemented, at least on the Flexicast QUIC source, to advance its state when all members of the flexicast flow sent MP_ACK frames to acknowledge some packets sent on the flexicast flow.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">Bottleneck or malicious receivers may slow down, and even block the transmission of data, thus impacting the quality of service for other receivers.
Similarly to <span>[<a href="#RFC9002" class="cite xref">RFC9002</a>]</span>, a Flexicast QUIC source may decide to stop the communication with a specific receiver if packet retransmissions do not trigger MP_ACK frames from this receiver to advance the state of communication.
A Flexicast QUIC source <span class="bcp14">SHOULD</span> remove bottleneck or malicious receivers from the flexicast flow in that case, and <span class="bcp14">MAY</span> continue transmitting data through the unicast path with these receivers instead, thus relying on <span>[<a href="#RFC9002" class="cite xref">RFC9002</a>]</span>, in case the severe losses occur because of the underlying multicast distribution tree.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">The Flexicast QUIC source is responsible to decide whether to send retransmitted frames on the flexicast flow to all receivers, or specifically to receivers individually on their unicast path.
Receivers are not impacted by this choice since <span>[<a href="#MULTIPATH-QUIC" class="cite xref">MULTIPATH-QUIC</a>]</span> specification authorizes to retransmit frames on another path than the initial path on which they were sent.
The first case would be more efficient if multiple receivers lost the same packet; the second case is more interesting for isolated losses to avoid healthy receivers receiving duplicate frames.<a href="#section-7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flow-and-congestion-control">
<section id="section-8">
      <h2 id="name-flow-and-congestion-control">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-flow-and-congestion-control" class="section-name selfRef">FLow and Congestion Control</a>
      </h2>
<p id="section-8-1">TODO: find a good mechanism for Flow Control. There are several possibilities, like requiring receivers to send new limits to stay in the group, or assume that the limits are of XXX bytes, and increase this over time unilaterally.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">TODO: what do we detail regarding the congestion control?<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">There are currently several possibilities regarding congestion control for Flexicast QUIC. A first idea is to maintain constant bit-rate delivery and exposing multiple flexicast flows operating at diffeent bit-rates.
As such, if a receiver sees degradation in its communication (e.g., congestion or increased delay in the network), it may switch to a lower bit-rate flexicast flow. However, this idea does not solve the problem of increasing the congestion in the network.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">The other idea outlines the possibility to take into account all receiver-specific bit-rate to chose the overall bit-rate on the flexicast flow, e.g., by requiring that the flexicast flow bit-rate is the lowest bit-rate among all receivers listening to this flexicast flow.
Since receivers regularly send MP_ACK frames, it is possible for the source to adjust a per-receiver bit-rate (or congestion window) and use the minimum value as the value for the flexicast flow.
Of course, such method paves the way to malicious receivers decreasing on-purpose the flexicast flow bit-rate. Applications <span class="bcp14">SHOULD</span> provide to a Flexicast QUIC source a "minimum bit-rate" to ensure a minimum quality of service for the receivers.
Malicious or bottleneck receivers with a per-receiver bit-rate below this minimum bit-rate <span class="bcp14">SHOULD</span> be removed from the flexicast flow membership.
Since the Flexicast QUIC source can unilaterally evict such receivers, it can adjust the flexicast flow bit-rate without considering these receivers.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">A mix of both approaches is also possible. A Flexicast QUIC source may expose multiple flexicast flow, each operating at different bit-rate windows. For example, a first window would operate at a minimum bit-rate of 2 Mbps and a maximum bit-rate of 5 Mbps; another flexicast flow would operate between 5 Mbps and 10 Mbps,...
Receivers falling below the 2 Mbps bit-rate <span class="bcp14">SHOULD</span> be evicted from flexicast delivery; a Flexicast QUIC source <span class="bcp14">MAY</span> decide to continue the delivery through the unicast path.<a href="#section-8-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-packet-protection">
<section id="section-9">
      <h2 id="name-packet-protection">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-packet-protection" class="section-name selfRef">Packet protection</a>
      </h2>
<p id="section-9-1">Packet protection for QUIC version 1 is specified in <span><a href="https://rfc-editor.org/rfc/rfc9001#section-5" class="relref">Section 5</a> of [<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span>.
<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-multipath-10#section-4" class="relref">Section 4</a> of [<a href="#MULTIPATH-QUIC" class="cite xref">MULTIPATH-QUIC</a>]</span> further expands this design when multiple paths with different packet number spaces are used.
Because the flexicast flow is shared among multiple receivers, this document modifies the design from <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-multipath-10#section-4" class="relref">Section 4</a> of [<a href="#MULTIPATH-QUIC" class="cite xref">MULTIPATH-QUIC</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="protection-keys">
<section id="section-9.1">
        <h3 id="name-protection-keys">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-protection-keys" class="section-name selfRef">Protection Keys</a>
        </h3>
<p id="section-9.1-1">This document extends the design from <span>[<a href="#MULTIPATH-QUIC" class="cite xref">MULTIPATH-QUIC</a>]</span> by requiring that all flexicast flows use different TLS protection keys. Of course, these protections keys <span class="bcp14">MUST</span> be different from the protection keys derived during the handshake between the source and any receiver.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">The per-flexicast flow protection keys are derived by the Flexicast QUIC source. The required material, e.g., master secret and used algorithm, are transmitted to admitted received through the FC_KEY <a href="#fc-key-frame" class="auto internal xref">Section 10.3</a> on the unicast path.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">Since no explicit path probing phase is used in Flexicast QUIC, the receiver can use the dedicated protection key context whenever receiving a packet from the flexicast flow directly after receiving the FC_KEY frame from the source.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nonce-calculation">
<section id="section-9.2">
        <h3 id="name-nonce-calculation">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-nonce-calculation" class="section-name selfRef">Nonce Calculation</a>
        </h3>
<p id="section-9.2-1"><span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-multipath-10#section-4" class="relref">Section 4</a> of [<a href="#MULTIPATH-QUIC" class="cite xref">MULTIPATH-QUIC</a>]</span> further expands the computation of the Nonce from <span><a href="https://rfc-editor.org/rfc/rfc9001#section-5.3" class="relref">Section 5.3</a> of [<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span> to integrate the least significant 32 bits of the Path ID to guarantee its uniqueness.
A flexicast flow is shared among multiple receivers simultaneously, thus requiring that all receivers share the same Path ID for the same flexicast flow. Since receivers are allowed to dynamically change the flexicast flows they listen, it is impossible to ensure that all receivers use the same Path ID for the same flexicast flow.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">TODO: add example?<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">However, since each flexicast flow uses its own set of TLS keys, the computation of the Nonce is decorelated between any pair of flexicast flows, and between any flexicast flow and any unicast path with a receiver. It is therefore not mandatory anymore to use the Path ID to ensure the uniqueness of the Nonce.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">To remain compliant with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-multipath-10#section-4.1" class="relref">Section 4.1</a> of [<a href="#MULTIPATH-QUIC" class="cite xref">MULTIPATH-QUIC</a>]</span>, Flexicast QUIC still uses the Path ID to compute the Nonce. However, to ensure that all receivers use the same Path ID no matter the flexicast flow they listen, the Path ID used for the nonce is always set to 1.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-update">
<section id="section-9.3">
        <h3 id="name-key-update">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-key-update" class="section-name selfRef">Key Update</a>
        </h3>
<p id="section-9.3-1">TODO<a href="#section-9.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-frames">
<section id="section-10">
      <h2 id="name-new-frames">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-new-frames" class="section-name selfRef">New Frames</a>
      </h2>
<p id="section-10-1">All frames defined in this document <span class="bcp14">MUST</span> only be sent in 1-RTT packets.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">If an endpoint receives a flexicast-specific frame in a different packet type, it <span class="bcp14">MUST</span> close the connection with an error of type FRAME_ENCODING_ERROR.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Receipt of flexicast-specific frames related to a Flexicast Flow ID that is not added by an endpoint <span class="bcp14">MUST</span> be treated as a connection error of type FC_PROTOCOL_VIOLATION.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">If an endpoint receives a flexicast-specific frame with a Flexicast Flow ID that it cannot process anymore (e.g., the flexicast flow might have been abandoned), it <span class="bcp14">MUST</span> silently ignore the frame.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">The new frames introduced below are for control-specific purpose only, and <span class="bcp14">MUST NOT</span> be sent on the Flexicast flow. Receipt of any of the following frames on the Flexicast flow <span class="bcp14">MUST</span> be trated as a connection error of type FC_PROTOCOL_VIOLATION.<a href="#section-10-5" class="pilcrow">¶</a></p>
<div id="fc-announce-frame">
<section id="section-10.1">
        <h3 id="name-fc_announce-frame">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-fc_announce-frame" class="section-name selfRef">FC_ANNOUNCE frame</a>
        </h3>
<p id="section-10.1-1">The FC_ANNOUNCE frame informs the receiver that a Flexicast flow is available or updated.
FC_ANNOUNCE frames <span class="bcp14">MUST NOT</span> be sent by the receiver. A Flexicast QUIC source receiving an FC_ANNOUNCE frame <span class="bcp14">MUST</span> close the connection with a connection error of type FC_PROTOCOL_VIOLATION.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">FC_ANNOUNCE frames are formatted as shown in <a href="#fig-fc-announce-frame-format" class="auto internal xref">Figure 4</a>.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<span id="name-fc_announce-frame-format"></span><div id="fig-fc-announce-frame-format">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-10.1-3.1">
<pre>
FC_ANNOUNCE Frame {
    Type (i) = TBD-00,
    Length (8),
    Flexicast Flow ID (8..160),
    Sequence number (i),
    IP Version (8),
    Source IP (32, 128),
    Group IP (32, 128),
    UDP Port (16),
    Ack delay timer (64),
}
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-fc_announce-frame-format" class="selfRef">FC_ANNOUNCE Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-10.1-4">FC_ANNOUNCE frames contain the following fields:<a href="#section-10.1-4" class="pilcrow">¶</a></p>
<p id="section-10.1-5">Length: An 8-bit unsigned internet containing the length of the Flexicast Flow ID. Values less than 1 and greated than 20 are invalid and <span class="bcp14">MUST</span> be treated as a connection error of type FRAME_ENCODING_ERROR.<a href="#section-10.1-5" class="pilcrow">¶</a></p>
<p id="section-10.1-6">Flexicast Flow ID: A Flexicast Flow ID of the specified length.<a href="#section-10.1-6" class="pilcrow">¶</a></p>
<p id="section-10.1-7">Sequence number: The monotically increasing sequence number related to the advertised Flexicast Flow ID.<a href="#section-10.1-7" class="pilcrow">¶</a></p>
<p id="section-10.1-8">IP Version: An 8-bit unsigned integer containing the version of IP used to advertise the Source IP and Group IP. Values different than 4 (for IPv4) and 6 (IPv6) are invalid and <span class="bcp14">MUST</span> be treated as a conneciton error of type FRAME_ENCODING_ERROR.<a href="#section-10.1-8" class="pilcrow">¶</a></p>
<p id="section-10.1-9">Source IP: The IP address of the multicast source, used for Single-Source Multicast.<a href="#section-10.1-9" class="pilcrow">¶</a></p>
<p id="section-10.1-10">Group IP: The IP address of the multicast group. The address <span class="bcp14">MUST</span> be a multicast address.<a href="#section-10.1-10" class="pilcrow">¶</a></p>
<p id="section-10.1-11">UDP Port: The UDP destination port.<a href="#section-10.1-11" class="pilcrow">¶</a></p>
<p id="section-10.1-12">Ack delay timer: A 64-bit unsigned integer containing the delay, in ms, between two acknowledgments from a receiver.<a href="#section-10.1-12" class="pilcrow">¶</a></p>
<p id="section-10.1-13">FC_ANNOUNCE frames are ack-eliciting. If a packet containing an FC_ANNOUNCE frame is considered lost, the peer <span class="bcp14">SHOULD</span> repeat it.<a href="#section-10.1-13" class="pilcrow">¶</a></p>
<p id="section-10.1-14">Sources are allowed to send multiple times FC_ANNOUNCE frames with an increasing sequence number for the same Flexicast Flow ID.
New FC_ANNOUNCE frames <span class="bcp14">MAY</span> contain updated information, e.g., a new Ack delay timer.<a href="#section-10.1-14" class="pilcrow">¶</a></p>
<p id="section-10.1-15">Sources are allowed to advertise multiple Flexicast flows by sending multiple parallel FC_ANNOUNCE frames with distinct Flexicast Flow IDs.
The Sequence number is linked to a specific Flexicast Flow ID. The same Sequence number can be used for two distinct Flexicast Flow IDs.<a href="#section-10.1-15" class="pilcrow">¶</a></p>
<p id="section-10.1-16">TODO: the frame should also contain a <code>Status</code> field to indicate if the flexicast flow is retired?<a href="#section-10.1-16" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fc-state-frame">
<section id="section-10.2">
        <h3 id="name-fc_state-frame">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-fc_state-frame" class="section-name selfRef">FC_STATE frame</a>
        </h3>
<p id="section-10.2-1">The FC_STATE frame informs the endpoint of the state of the Flexicast receiver in the Flexicast flow.
FC_STATE frames <span class="bcp14">MAY</span> be sent by both endpoints (i.e., receiver and source).<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">FC_STATE frames are formatted as shown in <a href="#fig-fc-state-frame-format" class="auto internal xref">Figure 5</a>.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<span id="name-fc_state-frame-format"></span><div id="fig-fc-state-frame-format">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-10.2-3.1">
<pre>
FC_STATE frame {
    Type (i) = TDB-01,
    Length (8),
    Flexicast Flow ID (8..160),
    Sequence number (i),
    Action (u64),
}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-fc_state-frame-format" class="selfRef">FC_STATE Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-10.2-4">FC_STATE frames contain the following fields:<a href="#section-10.2-4" class="pilcrow">¶</a></p>
<p id="section-10.2-5">Length: An 8-bit unsigned internet containing the length of the Flexicast Flow ID. Values less than 1 and greated than 20 are invalid and <span class="bcp14">MUST</span> be treated as a connection error of type FRAME_ENCODING_ERROR.<a href="#section-10.2-5" class="pilcrow">¶</a></p>
<p id="section-10.2-6">Flexicast Flow ID: The Flexicast Flow ID of the Flexicast flow that this frame relates to.<a href="#section-10.2-6" class="pilcrow">¶</a></p>
<p id="section-10.2-7">Sequence number: The monotically increasing sequence number related to the advertised Flexicast Flow ID.<a href="#section-10.2-7" class="pilcrow">¶</a></p>
<p id="section-10.2-8">Action: The bit-encoded action, defined in Section <a href="#fc-state-action" class="auto internal xref">Section 10.2.1</a>.<a href="#section-10.2-8" class="pilcrow">¶</a></p>
<p id="section-10.2-9">FC_STATE frames are ack-eliciting. If a packet containing an FC_STATE frame is considered lost, the peer <span class="bcp14">SHOULD</span> repeat it.<a href="#section-10.2-9" class="pilcrow">¶</a></p>
<p id="section-10.2-10">For a same Flexicast flow (i.e., identical Flexicast Flow ID), both endpoints use their own Sequence number.<a href="#section-10.2-10" class="pilcrow">¶</a></p>
<p id="section-10.2-11">A receiver sending an FC_STATE frame indicates the source its status regarding the Flexicast flow indicated by the Flexicast Flow ID.
The source <span class="bcp14">MAY</span> also send FC_STATE frames to a receiver to unilaterally change the status of the receiver within the Flexicast flow indicated by the Flexicast Flow ID.<a href="#section-10.2-11" class="pilcrow">¶</a></p>
<div id="fc-state-action">
<section id="section-10.2.1">
          <h4 id="name-fc_state-actions">
<a href="#section-10.2.1" class="section-number selfRef">10.2.1. </a><a href="#name-fc_state-actions" class="section-name selfRef">FC_STATE actions</a>
          </h4>
<p id="section-10.2.1-1">This section lists the defined Actions encoded in an FC_STATE frame. An endpoint receiving an unknown value <span class="bcp14">MUST</span> treat it as a connection error of type FC_PROTOCOL_VIOLATION.<a href="#section-10.2.1-1" class="pilcrow">¶</a></p>
<p id="section-10.2.1-2">JOIN (0x01): The receiver joins the Flexicast flow.<a href="#section-10.2.1-2" class="pilcrow">¶</a></p>
<p id="section-10.2.1-3">LEAVE (0x02): The receiver leaves the Flexicast flow.<a href="#section-10.2.1-3" class="pilcrow">¶</a></p>
<p id="section-10.2.1-4">READY (0x03): The receiver is ready to receive content on the Flexicast flow.<a href="#section-10.2.1-4" class="pilcrow">¶</a></p>
<p id="section-10.2.1-5">The actions JOIN and READY are receiver-specific. These actions <span class="bcp14">MUST NOT</span> be sent inside an FC_STATE frame sent by the source. A receiver receiving an FC_STATE frame with any of the following actions <span class="bcp14">MUST</span> treat it as a connection error of type FC_PROTOCOL_VIOLATION.
The action LEAVE <span class="bcp14">MAY</span> be sent by both the receiver and the source, as detailed in <a href="#sec-leave" class="auto internal xref">Section 6</a>.<a href="#section-10.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="fc-key-frame">
<section id="section-10.3">
        <h3 id="name-fc_key-frame">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-fc_key-frame" class="section-name selfRef">FC_KEY frame</a>
        </h3>
<p id="section-10.3-1">The FC_KEY frame informs a receiver with the decryption key of a Flexicast flow joined by the receiver.
FC_KEY frames <span class="bcp14">MUST NOT</span> be sent by the receiver. A Flexicast QUIC source receiving an FC_KEY frame <span class="bcp14">MUST</span> clone the connection with a connection error of type FC_PROTOCOL_VIOLATION.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">FC_KEY frames are formatted as shown in <a href="#fig-fc-key-frame-format" class="auto internal xref">Figure 6</a>.<a href="#section-10.3-2" class="pilcrow">¶</a></p>
<span id="name-fc_key-frame-format"></span><div id="fig-fc-key-frame-format">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-10.3-3.1">
<pre>
FC_KEY Frame {
    Type (i) = TDB-02,
    Length(8),
    Flexicast Flow ID(8..160),
    Sequence number (i),
    Packet number (i),
    Key length (i),
    Key (..),
    Algorithm (64),
}
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-fc_key-frame-format" class="selfRef">FC_KEY Frame Format</a>
          </figcaption></figure>
</div>
<p id="section-10.3-4">FC_KEY frames contain the following fields:<a href="#section-10.3-4" class="pilcrow">¶</a></p>
<p id="section-10.3-5">Length: An 8-bit unsigned internet containing the length of the Flexicast Flow ID. Values less than 1 and greated than 20 are invalid and <span class="bcp14">MUST</span> be treated as a connection error of type FRAME_ENCODING_ERROR.<a href="#section-10.3-5" class="pilcrow">¶</a></p>
<p id="section-10.3-6">Flexicast Flow ID: The Flexicast Flow ID of the Flexicast flow that this frame relates to.<a href="#section-10.3-6" class="pilcrow">¶</a></p>
<p id="section-10.3-7">Sequence number: The monotically increasing sequence number related to the advertised Flexicast Flow ID.<a href="#section-10.3-7" class="pilcrow">¶</a></p>
<p id="section-10.3-8">Packet number: The first packet number that the receiver must receive with this key,<a href="#section-10.3-8" class="pilcrow">¶</a></p>
<p id="section-10.3-9">Key length: A var-int indicating the length of the decryption key.<a href="#section-10.3-9" class="pilcrow">¶</a></p>
<p id="section-10.3-10">Key: Byte-sequence of the decryption key of the Flexicast flow.<a href="#section-10.3-10" class="pilcrow">¶</a></p>
<p id="section-10.3-11">Algorithm: The bit-encoded algorithm used for decryption, defined in Section <a href="#fc-key-algorithm" class="auto internal xref">Section 10.3.1</a>.<a href="#section-10.3-11" class="pilcrow">¶</a></p>
<p id="section-10.3-12">FC_KEY frames are ack-eliciting. If a packet containing an FC_STATE frame is considered lost, the peer <span class="bcp14">SHOULD</span> repeat it.<a href="#section-10.3-12" class="pilcrow">¶</a></p>
<p id="section-10.3-13">The source <span class="bcp14">MAY</span> send new FC_KEY frames with an increased sequence number to notify a new decryption key.
This mechanism can be used to provide backward and forward secrecy with dynamic Flexicast groups.<a href="#section-10.3-13" class="pilcrow">¶</a></p>
<div id="fc-key-algorithm">
<section id="section-10.3.1">
          <h4 id="name-fc_key-algorithms">
<a href="#section-10.3.1" class="section-number selfRef">10.3.1. </a><a href="#name-fc_key-algorithms" class="section-name selfRef">FC_KEY algorithms</a>
          </h4>
<p id="section-10.3.1-1">TODO: define the bit-encoded algorithms.<a href="#section-10.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-further">
<section id="section-11">
      <h2 id="name-discussion">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-discussion" class="section-name selfRef">Discussion</a>
      </h2>
<p id="section-11-1">This document has defined a simple extension to Multipath QUIC that enables a
QUIC connection to simulatenously use unicast paths and multicast trees
to deliver the same data to a set of receivers. The proposed protocol can be extended
in different ways and improvements will be proposed in separate documents. We
briefly describe some of these possible extensions.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">This version of Flexicast QUIC uses the existing QUIC mechanisms to retransmit
lost frames. It is well known that Forward Erasure Correction can improve the
performance of multicast transmission when losses occur. Several authors have
proposed techniques to add Forward Erasure Correction to QUIC <span>[<a href="#QUIRL" class="cite xref">QUIRL</a>]</span>, <span>[<a href="#rQUIC" class="cite xref">rQUIC</a>]</span>,
<span>[<a href="#I-D.draft-michel-quic-fec" class="cite xref">I-D.draft-michel-quic-fec</a>]</span>. FEC can be sent a priori to enable receivers
to recover from different packet losses without having to wait for retransmissions or
a posteriori by sending a repair symbol that enables different receivers to recover
different lost frames.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">This version of Flexicast QUIC uses a key shared between the source and all receivers
to authenticate and encrypt the data sent by the source over the multicast tree.
A malicious receiver who has received the shared keys could inject fake data over
the multicast tree provided that it can spoof the IP address of the source. Techniques
have been proposed to authenticate the frames sent by the source <span>[<a href="#I-D.draft-krose-multicast-security" class="cite xref">I-D.draft-krose-multicast-security</a>]</span>.
Subsequent documents will detail how Flexicast QUIC can be extended to support such
techniques.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">Multipath QUIC assumes that the congestion control mechanism operates per path. For
Flexicast QUIC, a different congestion control mechanism will be required for the
unicast paths and the multicast tree. For the former, the QUIC congestion control
mechanisms <span>[<a href="#RFC9002" class="cite xref">RFC9002</a>]</span> are applicable. For the latter, multicast specific congestion
control mechanisms such as <span>[<a href="#RFC4654" class="cite xref">RFC4654</a>]</span> will be required. The current prototype
uses a variant of the CUBIC congestion control.<a href="#section-11-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-12-1">To be provided in the next version of this document.<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-iana">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-13-1">IANA is requested to assign three new QUIC frame types from the
"QUIC Frame Types" registry available at
https://www.iana.org/assignments/quic/quic.xhtml#quic-frame-types<a href="#section-13-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13-2.1">
          <p id="section-13-2.1.1">TBD-00 for the FC_ANNOUNCE frame defined in <a href="#fc-announce-frame" class="auto internal xref">Section 10.1</a><a href="#section-13-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.2">
          <p id="section-13-2.2.1">TBD-01 for the FC_STATE frame defined in <a href="#fc-state-frame" class="auto internal xref">Section 10.2</a><a href="#section-13-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.3">
          <p id="section-13-2.3.1">TBD-02 for the FC_KEY frame defined in <a href="#fc-key-frame" class="auto internal xref">Section 10.3</a><a href="#section-13-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-13-3">IANA is requested to assign a new QUIC transport parameter
from the "QUIC Transport Parameters" registry available at
https://www.iana.org/assignments/quic/quic.xhtml#quic-transport<a href="#section-13-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13-4.1">
          <p id="section-13-4.1.1">TBD-03 for the flexicast_support transport parameter defined in <a href="#sec-handshake" class="auto internal xref">Section 4</a><a href="#section-13-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-combined-references">
<section id="section-14">
      <h2 id="name-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-14.1">
        <h3 id="name-normative-references">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="MULTIPATH-QUIC">[MULTIPATH-QUIC]</dt>
        <dd>
<span class="refAuthor">Liu, Y.</span>, <span class="refAuthor">Ma, Y.</span>, <span class="refAuthor">De Coninck, Q.</span>, <span class="refAuthor">Bonaventure, O.</span>, <span class="refAuthor">Huitema, C.</span>, and <span class="refAuthor">M. Kühlewind</span>, <span class="refTitle">"Multipath Extension for QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-multipath-10</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-multipath-10">https://datatracker.ietf.org/doc/html/draft-ietf-quic-multipath-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-TLS">[QUIC-TLS]</dt>
        <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">S. Turner, Ed.</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="seriesInfo">RFC 9001</span>, <span class="seriesInfo">DOI 10.17487/RFC9001</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9001">https://www.rfc-editor.org/rfc/rfc9001</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-TRANSPORT">[QUIC-TRANSPORT]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-14.2">
        <h3 id="name-informative-references">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="DIOT">[DIOT]</dt>
        <dd>
<span class="refAuthor">Diot, C.</span>, <span class="refAuthor">Levine, B.</span>, <span class="refAuthor">Lyles, B.</span>, <span class="refAuthor">Kassem, H.</span>, and <span class="refAuthor">D. Balensiefen</span>, <span class="refTitle">"Deployment issues for the IP multicast service and architecture"</span>, <span class="refContent">Institute of Electrical and Electronics Engineers (IEEE)</span>, <span class="seriesInfo">IEEE Network vol. 14, no. 1, pp. 78-88</span>, <span class="seriesInfo">DOI 10.1109/65.819174</span>, <time datetime="2000" class="refDate">2000</time>, <span>&lt;<a href="https://doi.org/10.1109/65.819174">https://doi.org/10.1109/65.819174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-krose-multicast-security">[I-D.draft-krose-multicast-security]</dt>
        <dd>
<span class="refAuthor">Rose, K.</span> and <span class="refAuthor">J. Holland</span>, <span class="refTitle">"Security and Privacy Considerations for Multicast Transports"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-krose-multicast-security-06</span>, <time datetime="2023-12-27" class="refDate">27 December 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-krose-multicast-security-06">https://datatracker.ietf.org/doc/html/draft-krose-multicast-security-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-michel-quic-fec">[I-D.draft-michel-quic-fec]</dt>
        <dd>
<span class="refAuthor">Michel, F.</span> and <span class="refAuthor">O. Bonaventure</span>, <span class="refTitle">"Forward Erasure Correction for QUIC loss recovery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-michel-quic-fec-01</span>, <time datetime="2023-10-23" class="refDate">23 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-michel-quic-fec-01">https://datatracker.ietf.org/doc/html/draft-michel-quic-fec-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.jholland-quic-multicast-05">[I-D.jholland-quic-multicast-05]</dt>
        <dd>
<span class="refAuthor">Holland, J.</span>, <span class="refAuthor">Pardue, L.</span>, and <span class="refAuthor">M. Franke</span>, <span class="refTitle">"Multicast Extension for QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-jholland-quic-multicast-05</span>, <time datetime="2024-07-07" class="refDate">7 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-jholland-quic-multicast-05">https://datatracker.ietf.org/doc/html/draft-jholland-quic-multicast-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.pardue-quic-http-mcast">[I-D.pardue-quic-http-mcast]</dt>
        <dd>
<span class="refAuthor">Pardue, L.</span>, <span class="refAuthor">Bradbury, R.</span>, and <span class="refAuthor">S. Hurst</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP) over multicast QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-pardue-quic-http-mcast-11</span>, <time datetime="2022-07-04" class="refDate">4 July 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-pardue-quic-http-mcast-11">https://datatracker.ietf.org/doc/html/draft-pardue-quic-http-mcast-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIRL">[QUIRL]</dt>
        <dd>
<span class="refAuthor">Michel, F.</span> and <span class="refAuthor">O. Bonaventure</span>, <span class="refTitle">"QUIRL: Flexible QUIC Loss Recovery for Low Latency Applications"</span>, <span class="refContent">Institute of Electrical and Electronics Engineers (IEEE)</span>, <span class="seriesInfo">IEEE/ACM Transactions on Networking pp. 1-12</span>, <span class="seriesInfo">DOI 10.1109/tnet.2024.3453759</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://doi.org/10.1109/tnet.2024.3453759">https://doi.org/10.1109/tnet.2024.3453759</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1112">[RFC1112]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span>, <span class="refTitle">"Host extensions for IP multicasting"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 1112</span>, <span class="seriesInfo">DOI 10.17487/RFC1112</span>, <time datetime="1989-08" class="refDate">August 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1112">https://www.rfc-editor.org/rfc/rfc1112</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4607">[RFC4607]</dt>
        <dd>
<span class="refAuthor">Holbrook, H.</span> and <span class="refAuthor">B. Cain</span>, <span class="refTitle">"Source-Specific Multicast for IP"</span>, <span class="seriesInfo">RFC 4607</span>, <span class="seriesInfo">DOI 10.17487/RFC4607</span>, <time datetime="2006-08" class="refDate">August 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4607">https://www.rfc-editor.org/rfc/rfc4607</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4654">[RFC4654]</dt>
        <dd>
<span class="refAuthor">Widmer, J.</span> and <span class="refAuthor">M. Handley</span>, <span class="refTitle">"TCP-Friendly Multicast Congestion Control (TFMCC): Protocol Specification"</span>, <span class="seriesInfo">RFC 4654</span>, <span class="seriesInfo">DOI 10.17487/RFC4654</span>, <time datetime="2006-08" class="refDate">August 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4654">https://www.rfc-editor.org/rfc/rfc4654</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9002">[RFC9002]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">I. Swett, Ed.</span>, <span class="refTitle">"QUIC Loss Detection and Congestion Control"</span>, <span class="seriesInfo">RFC 9002</span>, <span class="seriesInfo">DOI 10.17487/RFC9002</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9002">https://www.rfc-editor.org/rfc/rfc9002</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9293">[RFC9293]</dt>
        <dd>
<span class="refAuthor">Eddy, W., Ed.</span>, <span class="refTitle">"Transmission Control Protocol (TCP)"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 9293</span>, <span class="seriesInfo">DOI 10.17487/RFC9293</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9293">https://www.rfc-editor.org/rfc/rfc9293</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="rQUIC">[rQUIC]</dt>
      <dd>
<span class="refAuthor">Garrido, P.</span>, <span class="refAuthor">Sanchez, I.</span>, <span class="refAuthor">Ferlin, S.</span>, <span class="refAuthor">Aguero, R.</span>, and <span class="refAuthor">O. Alay</span>, <span class="refTitle">"rQUIC: Integrating FEC with QUIC for Robust Wireless Communications"</span>, <span class="refContent">IEEE</span>, <span class="seriesInfo">2019 IEEE Global Communications Conference (GLOBECOM)</span>, <span class="seriesInfo">DOI 10.1109/globecom38437.2019.9013401</span>, <time datetime="2019-12" class="refDate">December 2019</time>, <span>&lt;<a href="https://doi.org/10.1109/globecom38437.2019.9013401">https://doi.org/10.1109/globecom38437.2019.9013401</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Louis Navarre</span></div>
<div dir="auto" class="left"><span class="org">UCLouvain</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:louis.navarre@uclouvain.be" class="email">louis.navarre@uclouvain.be</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Olivier Bonaventure</span></div>
<div dir="auto" class="left"><span class="org">UCLouvain</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:olivier.bonaventure@uclouvain.be" class="email">olivier.bonaventure@uclouvain.be</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
